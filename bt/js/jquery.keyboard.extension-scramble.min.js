/* jQuery UI Virtual Keyboard Scramble Extension v1.0 for Keyboard v1.17.14+
 * By Rob Garrison ~ MIT license ~ https://github.com/Mottie/Keyboard */
(function(f){f.keyboard=f.keyboard||{};f.fn.addScramble=function(s){var t={targetKeys:/[a-z\d]/i,byRow:!0,randomizeOnce:!0};return this.each(function(){var n,a=f(this).data("keyboard");a&&(n=a.scramble_options=f.extend({},t,s),a.scramble_setup=function(r){var g,h,d,b,p,k,e,m,q,l,c;if(!a.randomizeOnce||!a.randomizeComplete)if(g=r.find(".ui-keyboard-keyset"),r.length){for(h=0;h<g.length;h++)if(d=g.eq(h),e=0,c=[],q=[],m=[],l=[],d.find("button, br").each(function(){"BR"===this.tagName?(n.byRow?(c.push(this),
q.push(!1),l[e]=c,m[e]=q,c=[],q=[]):(l[e]=this,m[e]=!1),e++):(k=f(this).attr("data-value")||"",k=1===k.length&&n.targetKeys.test(k)?k:!1,n.byRow?(c.push(this),q.push(k)):(l[e]=this,m[e]=k,e++))}),d.find(".ui-keyboard-button-endrow").remove(),n.byRow)for(p=0;p<l.length;p++)for(c=a.shuffle(l[p],m[p]),b=0;b<c.length;b++)d.append(c[b]);else for(c=a.shuffle(l,m),b=0;b<c.length;b++)d.append(c[b]);a.randomizeOnce||a.randomizeComplete||a.$el.bind("beforeVisible.keyboard",function(){a.rescramble&&(a.$keyboard=
a.scramble_setup(a.$keyboard));a.rescramble=!0});a.randomizeComplete=!0;return r}},a.shuffle=function(a,g){for(var h,d,b=a.length;0<b;)d=Math.floor(Math.random()*b),!1===g[b-1]&&b--,!1!==g[b-1]&&!1!==g[d]&&(b--,h=a[b],a[b]=a[d],a[d]=h);return a},a.options.create=function(){var f=a.buildKeyboard();return a.scramble_setup(f)})})}})(jQuery);